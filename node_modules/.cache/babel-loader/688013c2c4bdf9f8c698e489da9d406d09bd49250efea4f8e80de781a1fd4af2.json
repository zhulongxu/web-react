{"ast":null,"code":"import { debounce } from './util';\nexport function createSensor(element) {\n  let sensor = null;\n  let listeners = [];\n  const create = () => {\n    if (getComputedStyle(element).position === 'static') {\n      const style = element.style;\n      style.position = 'relative';\n    }\n    const obj = document.createElement('object');\n    obj.onload = () => {\n      obj.contentDocument.defaultView.addEventListener('resize', trigger);\n      trigger();\n    };\n    obj.style.display = 'block';\n    obj.style.position = 'absolute';\n    obj.style.top = '0';\n    obj.style.left = '0';\n    obj.style.height = '100%';\n    obj.style.width = '100%';\n    obj.style.overflow = 'hidden';\n    obj.style.pointerEvents = 'none';\n    obj.style.zIndex = '-1';\n    obj.style.opacity = '0';\n    obj.setAttribute('tabindex', '-1');\n    obj.type = 'text/html';\n    element.appendChild(obj);\n    // for ie, should set data attribute delay, or will be white screen\n    obj.data = 'about:blank';\n    return obj;\n  };\n  const trigger = debounce(() => {\n    listeners.forEach(listener => listener(element));\n  });\n  const bind = listener => {\n    if (!sensor) {\n      sensor = create();\n    }\n    if (listeners.indexOf(listener) === -1) {\n      listeners.push(listener);\n    }\n  };\n  const destroy = () => {\n    if (sensor && sensor.parentNode) {\n      if (sensor.contentDocument) {\n        sensor.contentDocument.defaultView.removeEventListener('resize', trigger);\n      }\n      sensor.parentNode.removeChild(sensor);\n      sensor = null;\n      listeners = [];\n    }\n  };\n  const unbind = listener => {\n    const idx = listeners.indexOf(listener);\n    if (idx !== -1) {\n      listeners.splice(idx, 1);\n    }\n    // no listener, and sensor is exist then destroy the sensor\n    if (listeners.length === 0 && sensor) {\n      destroy();\n    }\n  };\n  return {\n    element,\n    bind,\n    destroy,\n    unbind\n  };\n}","map":{"version":3,"names":["debounce","createSensor","element","sensor","listeners","create","getComputedStyle","position","style","obj","document","createElement","onload","contentDocument","defaultView","addEventListener","trigger","display","top","left","height","width","overflow","pointerEvents","zIndex","opacity","setAttribute","type","appendChild","data","forEach","listener","bind","indexOf","push","destroy","parentNode","removeEventListener","removeChild","unbind","idx","splice","length"],"sources":["/home/devbox/project/node_modules/.pnpm/@antv+x6-common@2.0.17/node_modules/@antv/x6-common/src/size-sensor/sensors/object.ts"],"sourcesContent":["import { debounce } from './util'\nimport { Listener, Sensor } from './types'\n\nexport function createSensor(element: Element): Sensor {\n  let sensor: HTMLObjectElement | null = null\n  let listeners: Listener[] = []\n\n  const create = () => {\n    if (getComputedStyle(element).position === 'static') {\n      const style = (element as HTMLElement).style\n      style.position = 'relative'\n    }\n\n    const obj = document.createElement('object')\n    obj.onload = () => {\n      obj.contentDocument!.defaultView!.addEventListener('resize', trigger)\n      trigger()\n    }\n    obj.style.display = 'block'\n    obj.style.position = 'absolute'\n    obj.style.top = '0'\n    obj.style.left = '0'\n    obj.style.height = '100%'\n    obj.style.width = '100%'\n    obj.style.overflow = 'hidden'\n    obj.style.pointerEvents = 'none'\n    obj.style.zIndex = '-1'\n    obj.style.opacity = '0'\n    obj.setAttribute('tabindex', '-1')\n    obj.type = 'text/html'\n\n    element.appendChild(obj)\n    // for ie, should set data attribute delay, or will be white screen\n    obj.data = 'about:blank'\n    return obj\n  }\n\n  const trigger = debounce(() => {\n    listeners.forEach((listener) => listener(element))\n  })\n\n  const bind = (listener: Listener) => {\n    if (!sensor) {\n      sensor = create()\n    }\n\n    if (listeners.indexOf(listener) === -1) {\n      listeners.push(listener)\n    }\n  }\n\n  const destroy = () => {\n    if (sensor && sensor.parentNode) {\n      if (sensor.contentDocument) {\n        sensor.contentDocument!.defaultView!.removeEventListener(\n          'resize',\n          trigger,\n        )\n      }\n      sensor.parentNode.removeChild(sensor)\n      sensor = null\n      listeners = []\n    }\n  }\n\n  const unbind = (listener: Listener) => {\n    const idx = listeners.indexOf(listener)\n    if (idx !== -1) {\n      listeners.splice(idx, 1)\n    }\n\n    // no listener, and sensor is exist then destroy the sensor\n    if (listeners.length === 0 && sensor) {\n      destroy()\n    }\n  }\n\n  return {\n    element,\n    bind,\n    destroy,\n    unbind,\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}