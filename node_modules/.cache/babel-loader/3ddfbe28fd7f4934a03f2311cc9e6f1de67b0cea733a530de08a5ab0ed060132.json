{"ast":null,"code":"var __rest = this && this.__rest || function (s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\nimport { StringExt, Dom, Vector } from '@antv/x6-common';\nimport { Filter } from '../registry';\nimport { Markup } from '../view';\nimport { Base } from './base';\nexport class DefsManager extends Base {\n  get cid() {\n    return this.graph.view.cid;\n  }\n  get svg() {\n    return this.view.svg;\n  }\n  get defs() {\n    return this.view.defs;\n  }\n  isDefined(id) {\n    return this.svg.getElementById(id) != null;\n  }\n  filter(options) {\n    let filterId = options.id;\n    const name = options.name;\n    if (!filterId) {\n      filterId = `filter-${name}-${this.cid}-${StringExt.hashcode(JSON.stringify(options))}`;\n    }\n    if (!this.isDefined(filterId)) {\n      const fn = Filter.registry.get(name);\n      if (fn == null) {\n        return Filter.registry.onNotFound(name);\n      }\n      const markup = fn(options.args || {});\n      // Set the filter area to be 3x the bounding box of the cell\n      // and center the filter around the cell.\n      const attrs = Object.assign(Object.assign({\n        x: -1,\n        y: -1,\n        width: 3,\n        height: 3,\n        filterUnits: 'objectBoundingBox'\n      }, options.attrs), {\n        id: filterId\n      });\n      Vector.create(Markup.sanitize(markup), attrs).appendTo(this.defs);\n    }\n    return filterId;\n  }\n  gradient(options) {\n    let id = options.id;\n    const type = options.type;\n    if (!id) {\n      id = `gradient-${type}-${this.cid}-${StringExt.hashcode(JSON.stringify(options))}`;\n    }\n    if (!this.isDefined(id)) {\n      const stops = options.stops;\n      const arr = stops.map(stop => {\n        const opacity = stop.opacity != null && Number.isFinite(stop.opacity) ? stop.opacity : 1;\n        return `<stop offset=\"${stop.offset}\" stop-color=\"${stop.color}\" stop-opacity=\"${opacity}\"/>`;\n      });\n      const markup = `<${type}>${arr.join('')}</${type}>`;\n      const attrs = Object.assign({\n        id\n      }, options.attrs);\n      Vector.create(markup, attrs).appendTo(this.defs);\n    }\n    return id;\n  }\n  marker(options) {\n    const {\n        id,\n        refX,\n        refY,\n        markerUnits,\n        markerOrient,\n        tagName,\n        children\n      } = options,\n      attrs = __rest(options, [\"id\", \"refX\", \"refY\", \"markerUnits\", \"markerOrient\", \"tagName\", \"children\"]);\n    let markerId = id;\n    if (!markerId) {\n      markerId = `marker-${this.cid}-${StringExt.hashcode(JSON.stringify(options))}`;\n    }\n    if (!this.isDefined(markerId)) {\n      if (tagName !== 'path') {\n        // remove unnecessary d attribute inherit from standard edge.\n        delete attrs.d;\n      }\n      const pathMarker = Vector.create('marker', {\n        refX,\n        refY,\n        id: markerId,\n        overflow: 'visible',\n        orient: markerOrient != null ? markerOrient : 'auto',\n        markerUnits: markerUnits || 'userSpaceOnUse'\n      }, children ? children.map(_a => {\n        var {\n            tagName\n          } = _a,\n          other = __rest(_a, [\"tagName\"]);\n        return Vector.create(`${tagName}` || 'path', Dom.kebablizeAttrs(Object.assign(Object.assign({}, attrs), other)));\n      }) : [Vector.create(tagName || 'path', Dom.kebablizeAttrs(attrs))]);\n      this.defs.appendChild(pathMarker.node);\n    }\n    return markerId;\n  }\n  remove(id) {\n    const elem = this.svg.getElementById(id);\n    if (elem && elem.parentNode) {\n      elem.parentNode.removeChild(elem);\n    }\n  }\n}","map":{"version":3,"names":["StringExt","Dom","Vector","Filter","Markup","Base","DefsManager","cid","graph","view","svg","defs","isDefined","id","getElementById","filter","options","filterId","name","hashcode","JSON","stringify","fn","registry","get","onNotFound","markup","args","attrs","Object","assign","x","y","width","height","filterUnits","create","sanitize","appendTo","gradient","type","stops","arr","map","stop","opacity","Number","isFinite","offset","color","join","marker","refX","refY","markerUnits","markerOrient","tagName","children","__rest","markerId","d","pathMarker","overflow","orient","_a","other","kebablizeAttrs","appendChild","node","remove","elem","parentNode","removeChild"],"sources":["/home/devbox/project/node_modules/.pnpm/@antv+x6@2.18.1/node_modules/@antv/x6/src/graph/defs.ts"],"sourcesContent":["import { StringExt, Dom, Vector } from '@antv/x6-common'\nimport { Attr, Filter, Marker } from '../registry'\nimport { Markup } from '../view'\nimport { Base } from './base'\n\nexport class DefsManager extends Base {\n  protected get cid() {\n    return this.graph.view.cid\n  }\n\n  protected get svg() {\n    return this.view.svg\n  }\n\n  protected get defs() {\n    return this.view.defs\n  }\n\n  protected isDefined(id: string) {\n    return this.svg.getElementById(id) != null\n  }\n\n  filter(options: DefsManager.FilterOptions) {\n    let filterId = options.id\n    const name = options.name\n    if (!filterId) {\n      filterId = `filter-${name}-${this.cid}-${StringExt.hashcode(\n        JSON.stringify(options),\n      )}`\n    }\n\n    if (!this.isDefined(filterId)) {\n      const fn = Filter.registry.get(name)\n      if (fn == null) {\n        return Filter.registry.onNotFound(name)\n      }\n\n      const markup = fn(options.args || {})\n\n      // Set the filter area to be 3x the bounding box of the cell\n      // and center the filter around the cell.\n      const attrs = {\n        x: -1,\n        y: -1,\n        width: 3,\n        height: 3,\n        filterUnits: 'objectBoundingBox',\n        ...options.attrs,\n        id: filterId,\n      }\n      Vector.create(Markup.sanitize(markup), attrs).appendTo(this.defs)\n    }\n\n    return filterId\n  }\n\n  gradient(options: DefsManager.GradientOptions) {\n    let id = options.id\n    const type = options.type\n    if (!id) {\n      id = `gradient-${type}-${this.cid}-${StringExt.hashcode(\n        JSON.stringify(options),\n      )}`\n    }\n\n    if (!this.isDefined(id)) {\n      const stops = options.stops\n      const arr = stops.map((stop) => {\n        const opacity =\n          stop.opacity != null && Number.isFinite(stop.opacity)\n            ? stop.opacity\n            : 1\n\n        return `<stop offset=\"${stop.offset}\" stop-color=\"${stop.color}\" stop-opacity=\"${opacity}\"/>`\n      })\n\n      const markup = `<${type}>${arr.join('')}</${type}>`\n      const attrs = { id, ...options.attrs }\n      Vector.create(markup, attrs).appendTo(this.defs)\n    }\n\n    return id\n  }\n\n  marker(options: DefsManager.MarkerOptions) {\n    const {\n      id,\n      refX,\n      refY,\n      markerUnits,\n      markerOrient,\n      tagName,\n      children,\n      ...attrs\n    } = options\n    let markerId = id\n    if (!markerId) {\n      markerId = `marker-${this.cid}-${StringExt.hashcode(\n        JSON.stringify(options),\n      )}`\n    }\n\n    if (!this.isDefined(markerId)) {\n      if (tagName !== 'path') {\n        // remove unnecessary d attribute inherit from standard edge.\n        delete attrs.d\n      }\n\n      const pathMarker = Vector.create(\n        'marker',\n        {\n          refX,\n          refY,\n          id: markerId,\n          overflow: 'visible',\n          orient: markerOrient != null ? markerOrient : 'auto',\n          markerUnits: markerUnits || 'userSpaceOnUse',\n        },\n        children\n          ? children.map(({ tagName, ...other }) =>\n              Vector.create(\n                `${tagName}` || 'path',\n                Dom.kebablizeAttrs({\n                  ...attrs,\n                  ...other,\n                }),\n              ),\n            )\n          : [Vector.create(tagName || 'path', Dom.kebablizeAttrs(attrs))],\n      )\n\n      this.defs.appendChild(pathMarker.node)\n    }\n\n    return markerId\n  }\n\n  remove(id: string) {\n    const elem = this.svg.getElementById(id)\n    if (elem && elem.parentNode) {\n      elem.parentNode.removeChild(elem)\n    }\n  }\n}\n\nexport namespace DefsManager {\n  export type MarkerOptions = Marker.Result\n\n  export interface GradientOptions {\n    id?: string\n    type: string\n    stops: {\n      offset: number\n      color: string\n      opacity?: number\n    }[]\n    attrs?: Attr.SimpleAttrs\n  }\n\n  export type FilterOptions = (Filter.NativeItem | Filter.ManaualItem) & {\n    id?: string\n    attrs?: Attr.SimpleAttrs\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}